<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The AMC ProofBuilder</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        /* Tab styles */
        .tab-btn.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
            border-color: #4f46e5;
        }
        .tab-btn {
            background-color: white;
            color: #374151; /* gray-700 */
            border: 1px solid #d1d5db; /* gray-300 */
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Proof Card flip styles */
        .proof-card {
            perspective: 1000px;
            cursor: pointer;
        }
        .proof-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .proof-card.is-flipped .proof-card-inner {
            transform: rotateY(180deg);
        }
        .proof-card-front,
        .proof-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid #e5e7eb;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .proof-card-front {
            background-color: white;
        }
        .proof-card-back {
            background-color: #f9fafb; /* gray-50 */
            transform: rotateY(180deg);
            overflow-y: auto;
        }
        /* Styling for the list inside the proof card back */
        .proof-card-back dl {
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.75rem;
            margin-bottom: 0.75rem;
        }
        .proof-card-back dl:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .proof-card-back dt {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #4f46e5; /* indigo-600 */
        }
        .proof-card-back dd {
            font-size: 0.875rem;
            color: #374151; /* gray-700 */
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto max-w-7xl p-4 md:p-8">
        
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-slate-900 mb-2">The AMC ProofBuilder</h1>
            <p class="text-xl text-slate-600">A Workshop for Practical Cooperation</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="flex flex-wrap gap-3 mb-8" id="tab-nav">
            <button class="tab-btn active py-2 px-5 rounded-full font-semibold shadow-sm" data-tab="library">1. Proof Library</button>
            <button class="tab-btn py-2 px-5 rounded-full font-semibold shadow-sm" data-tab="wizard">2. ProofBuilder Wizard</button>
            <button class="tab-btn py-2 px-5 rounded-full font-semibold shadow-sm" data-tab="sandbox">3. Sandbox & Studio</button>
        </nav>

        <!-- Main Content Area -->
        <main id="tab-content-wrapper">

            <!-- ========================== -->
            <!-- Tab 1: Proof Library       -->
            <!-- ========================== -->
            <section id="library" class="tab-content active">
                <h2 class="text-3xl font-semibold text-indigo-600 mb-4">1. The Proof Library (Inspiration)</h2>
                <p class="text-lg text-slate-700 leading-relaxed mb-8">
                    These are real-world examples of "Proofs of Care." They are "assurance cases" you can audit. 
                    <br>
                    <strong class="font-semibold text-indigo-700">Click any card to flip it over and see the full proof.</strong>
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    
                    <!-- Proof Card 1: Health Access -->
                    <div class="proof-card h-[400px]">
                        <div class="proof-card-inner">
                            <!-- Card Front -->
                            <div class="proof-card-front p-6 justify-between">
                                <div>
                                    <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">L2 - Branch</span>
                                    <h3 class="text-2xl font-bold text-slate-900">Health Access</h3>
                                    <p class="text-lg text-slate-600 mt-1">Reducing Clinic No-Shows</p>
                                </div>
                                <div class="mt-4">
                                    <p class="text-3xl font-bold text-green-600">−22% to −32%</p>
                                    <p class="text-slate-500">No-Show Rate in 16 Weeks</p>
                                    <p class="mt-6 text-sm font-semibold text-indigo-600 text-center">Click to See Full Proof</p>
                                </div>
                            </div>
                            <!-- Card Back -->
                            <div class="proof-card-back p-6">
                                <h4 class="text-lg font-bold text-slate-800 mb-4">Proof: Health Access</h4>
                                <dl>
                                    <dt>Function & Context</dt>
                                    <dd>Reduce specialty-care no-shows in Clinics A/B for adults 18-64.</dd>
                                </dl>
                                <dl>
                                    <dt>Outcome Band</dt>
                                    <dd>−22% to −32% no-shows in 16 wks (center −27%).</dd>
                                </dl>
                                <dl>
                                    <dt>Protocol</dt>
                                    <dd>SMS reminders + peer navigator + transit voucher.</dd>
                                </dl>
                                <dl>
                                    <dt>Evidence & Robustness</dt>
                                    <dd>Stepped-wedge design. Second-site replication at −24%.</dd>
                                </dl>
                                <dl>
                                    <dt>Identity Integrity (ATCF)</dt>
                                    <dd>Opt-in at each step. Exit honored. Role matching by language/gender. Zero coercion reports.</dd>
                                </dl>
                                <dl>
                                    <dt>Failure Envelope</dt>
                                    <dd>Fails if no transit partner exists; effect collapses.</dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                    <!-- Proof Card 2: Neighborhood Energy -->
                    <div class="proof-card h-[400px]">
                        <div class="proof-card-inner">
                            <!-- Card Front -->
                            <div class="proof-card-front p-6 justify-between">
                                <div>
                                    <span class="inline-block bg-purple-100 text-purple-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">L3 - Grove</span>
                                    <h3 class="text-2xl font-bold text-slate-900">Neighborhood Energy</h3>
                                    <p class="text-lg text-slate-600 mt-1">Peak Demand Shaving</p>
                                </div>
                                <div class="mt-4">
                                    <p class="text-3xl font-bold text-green-600">−35% to −45%</p>
                                    <p class="text-slate-500">Peak Demand (Summer Evenings)</p>
                                    <p class="mt-6 text-sm font-semibold text-indigo-600 text-center">Click to See Full Proof</p>
                                </div>
                            </div>
                            <!-- Card Back -->
                            <div class="proof-card-back p-6">
                                <h4 class="text-lg font-bold text-slate-800 mb-4">Proof: Neighborhood Energy</h4>
                                <dl>
                                    <dt>Function & Context</dt>
                                    <dd>Reduce peak energy demand across six blocks in summer evenings.</dd>
                                </dl>
                                <dl>
                                    <dt>Outcome Band</dt>
                                    <dd>−35% to −45% peak demand.</dd>
                                </dl>
                                <dl>
                                    <dt>Protocol</dt>
                                    <dd>Micro-grids + appliance timers + "quiet hour" social norm.</dd>
                                </dl>
                                <dl>
                                    <dt>Evidence & Robustness</dt>
                                    <dd>Season-to-season stability. Independent meter audit.</dd>
                                </dl>
                                <dl>
                                    <dt>Identity Integrity (ATCF)</dt>
                                    <dd>Opt-out respected. No intrusion beyond opt-in timers. Households define dignity lines.</dd>
                                </dl>
                                <dl>
                                    <dt>Failure Envelope</dt>
                                    <dd>Fails due to landlord-tenant split incentives. Fix w/ shared-savings clauses.</dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                    <!-- Proof Card 3: Housing Anti-Aggregation -->
                    <div class="proof-card h-[400px]">
                        <div class="proof-card-inner">
                            <!-- Card Front -->
                            <div class="proof-card-front p-6 justify-between">
                                <div>
                                    <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">L2 - Branch</span>
                                    <h3 class="text-2xl font-bold text-slate-900">Inclusive Housing</h3>
                                    <p class="text-lg text-slate-600 mt-1">Anti-Aggregation Design</p>
                                </div>
                                <div class="mt-4">
                                    <p class="text-3xl font-bold text-green-600">−25% to −40%</p>
                                    <p class="text-slate-500">Emergent Clustering (Schelling)</p>
                                    <p class="mt-6 text-sm font-semibold text-indigo-600 text-center">Click to See Full Proof</p>
                                </div>
                            </div>
                            <!-- Card Back -->
                            <div class="proof-card-back p-6">
                                <h4 class="text-lg font-bold text-slate-800 mb-4">Proof: Inclusive Housing</h4>
                                <dl>
                                    <dt>Function & Context</dt>
                                    <dd>Reduce emergent clustering using mix-radius rules & "bridge group" incentives.</dd>
                                </dl>
                                <dl>
                                    <dt>Outcome Band</dt>
                                    <dd>25–40% reduction in clustering.</dd>
                                </dl>
                                <dl>
                                    <dt>Protocol</dt>
                                    <dd>Keep freedom to choose. Alter search patterns (expand radius, seed mixed-amenity hubs).</dd>
                                </dl>
                                <dl>
                                    <dt>Evidence & Robustness</dt>
                                    <dd>ABM sandbox previews. Real-world rollout with quarterly edge metrics.</dd>
                                </dl>
                                <dl>
                                    <dt>Identity Integrity (ATCF)</dt>
                                    <dd>No one pressured to relocate. Incentives support *additional* options, not penalties.</dd>
                                </dl>
                                <dl>
                                    <dt>Failure Envelope</dt>
                                    <dd>Fails when public transit is poor. Solution must shift to mobility/amenity placement.</dd>
                                </dl>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <!-- ========================== -->
            <!-- Tab 2: ProofBuilder Wizard -->
            <!-- ========================== -->
            <section id="wizard" class="tab-content">
                <h2 class="text-3xl font-semibold text-indigo-600 mb-4">2. The ProofBuilder Wizard (Creation)</h2>
                <p class="text-lg text-slate-700 leading-relaxed mb-8">
                    Create your own "L0 - Seed" Proof. This is a covenant: "prove small, publish outcomes, protect every participant."
                </p>

                <form id="proof-builder-form" class="space-y-10">
                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <legend class="text-xl font-semibold text-slate-900 px-2">Step 1: Function & Context</legend>
                        <p class="text-slate-600 mb-4">What will you do, and where/for whom?</p>
                        <textarea id="wiz-function" class="w-full h-24 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="e.g., 'Reduce food waste from campus dining halls (A & B) by collecting edible surplus for the campus food pantry.'"></textarea>
                    </fieldset>

                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <legend class="text-xl font-semibold text-slate-900 px-2">Step 2: Outcome Band</legend>
                        <p class="text-slate-600 mb-4">What is your baseline? What is the expected range of success?</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input id="wiz-baseline" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Baseline (e.g., '~50 lbs/day wasted')">
                            <input id="wiz-band" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Outcome Band (e.g., '20-30 lbs/day rescued')">
                        </div>
                    </fieldset>

                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <legend class="text-xl font-semibold text-slate-900 px-2">Step 3: Replicable Protocol</legend>
                        <p class="text-slate-600 mb-4">What are the minimal, replicable steps?</p>
                        <textarea id="wiz-protocol" class="w-full h-24 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="e.g., '1. Two volunteers per hall. 2. Collect surplus at 8 PM. 3. Weigh and store in pantry fridge.'"></textarea>
                    </fieldset>

                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <legend class="text-xl font-semibold text-slate-900 px-2">Step 4: Evidence & Robustness</legend>
                        <p class="text-slate-600 mb-4">How will you know it works? How will you check it?</p>
                        <textarea id="wiz-evidence" class="w-full h-24 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="e.g., 'Simple pre/post comparison. Daily weigh-in log, open to all. Check for 4 weeks.'"></textarea>
                    </fieldset>

                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-indigo-500 ring-2 ring-indigo-200">
                        <legend class="text-xl font-semibold text-indigo-700 px-2">Step 5: Identity Integrity (ATCF "Soul-Safety")</legend>
                        <p class="text-slate-600 mb-4">The ethical "Do No Harm" constraint. How will you protect participants?</p>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input type="checkbox" id="wiz-check-opt-in" class="h-5 w-5 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500">
                                <span class="ml-3 text-slate-700">Clear, easy, 100% voluntary opt-in.</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="wiz-check-exit" class="h-5 w-5 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500">
                                <span class="ml-3 text-slate-700">"Right of Exit" is clear, easy, and non-punitive.</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="wiz-check-no-coercion" class="h-5 w-5 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500">
                                <span class="ml-3 text-slate-700">Protocol does not coerce or manipulate.</span>
                            </label>
                        </div>
                    </fieldset>

                    <fieldset class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <legend class="text-xl font-semibold text-slate-900 px-2">Step 6: Governance & Failure Envelope</legend>
                        <p class="text-slate-600 mb-4">Who is the steward? Where do you expect this to fail?</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input id="wiz-steward" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Steward (e.g., 'Campus Green Club')">
                            <input id="wiz-failure" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Failure Envelope (e.g., 'Fails during exams')">
                        </div>
                    </fieldset>

                    <button id="generate-proof-btn" class="w-full bg-green-600 text-white font-bold py-4 px-8 rounded-lg text-lg shadow-lg hover:bg-green-700 transition-all">
                        Generate My "L0 - Seed" Proof Card
                    </button>
                </form>

                <div id="new-proof-container" class="mt-12 hidden">
                    <h2 class="text-3xl font-semibold text-slate-900 mb-8 text-center">Your Generated Proof</h2>
                    <div id="new-proof-output" class="max-w-md mx-auto">
                        <!-- New proof card will be injected here by JS -->
                    </div>
                </div>
            </section>

            <!-- ========================== -->
            <!-- Tab 3: Sandbox & Studio    -->
            <!-- ========================== -->
            <section id="sandbox" class="tab-content">
                <h2 class="text-3xl font-semibold text-indigo-600 mb-4">3. The Sandbox & Studio (Teaching Tools)</h2>
                <p class="text-lg text-slate-700 leading-relaxed mb-8">
                    Use these tools to practice the key skills of the AMC: translating, auditing, and checking for integrity.
                </p>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <!-- Tool 1: Translation Studio -->
                    <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <h3 class="text-2xl font-semibold text-slate-900 mb-4">A. The Translation Studio</h3>
                        <p class="text-slate-600 mb-6">"One deed, many reasons." Take one functional proof and translate it into multiple moral grammars to welcome diverse collaborators.</p>
                        
                        <label classs="block text-sm font-medium text-slate-700 mb-2">A Shared Function:</label>
                        <p class="text-lg font-semibold text-indigo-700 p-3 bg-indigo-50 rounded-md mb-4">"Reduce clinic no-shows."</p>
                        
                        <label for="trans-justice" class="block text-sm font-medium text-slate-700">Translation for Justice:</label>
                        <input id="trans-justice" type="text" class="w-full p-2 mb-3 border border-gray-300 rounded-lg" placeholder="e.g., 'Ensuring equitable access for all.'">
                        
                        <label for="trans-thrift" class="block text-sm font-medium text-slate-700">Translation for Thrift/Efficiency:</label>
                        <input id="trans-thrift" type="text" class="w-full p-2 mb-3 border border-gray-300 rounded-lg" placeholder="e.g., 'Saving $50k in wasted appointments.'">
                        
                        <label for="trans-community" class="block text-sm font-medium text-slate-700">Translation for Community:</label>
                        <input id="trans-community" type="text" class="w-full p-2 mb-3 border border-gray-300 rounded-lg" placeholder="e.g., 'Making sure our neighbors get help.'">
                    </div>

                    <!-- Tool 2: Failure Explorer -->
                    <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <h3 class="text-2xl font-semibold text-slate-900 mb-4">B. The Failure Explorer</h3>
                        <p class="text-slate-600 mb-6">An "Adversarial Audit." Proofs are strong because they *publish their failures*. Test what happens when you push a proof outside its envelope.</p>
                        
                        <label for="fail-proof" class="block text-sm font-medium text-slate-700 mb-2">Select a Proof:</label>
                        <select id="fail-proof" class="w-full p-2 mb-3 border border-gray-300 rounded-lg">
                            <option value="energy">Neighborhood Energy</option>
                            <option value="housing">Inclusive Housing</option>
                        </select>

                        <label for="fail-stress" class="block text-sm font-medium text-slate-700 mb-2">Select a Stressor:</label>
                        <select id="fail-stress" class="w-full p-2 mb-3 border border-gray-300 rounded-lg">
                            <option value="none">-- Select a stressor --</option>
                            <option value="landlord">Inject: Landlord-tenant split incentive</option>
                            <option value="transit">Inject: Poor public transit</option>
                            <option value="fines">Inject: Coercive 'fines' for non-participation</option>
                        </select>
                        
                        <button id="fail-run-btn" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700">Run Audit</button>

                        <div id="fail-result" class="mt-4 p-4 rounded-lg text-center font-semibold hidden"></div>
                    </div>

                    <!-- Tool 3: ATCF Check-in -->
                    <div class="p-6 bg-white rounded-2xl shadow-lg border border-gray-200">
                        <h3 class="text-2xl font-semibold text-slate-900 mb-4">C. The ATCF Check-In</h3>
                        <p class="text-slate-600 mb-6">A tool for stewards to monitor "soul-safety." A good proof must preserve the "core integrity" of all participants.</p>
                        
                        <div class="space-y-4">
                            <p class="font-medium text-slate-700">1. Did you feel free to opt-out at any time?</p>
                            
                            <p class="font-medium text-slate-700">2. How would you rate the 'dignity' of this process for you? (1=Low, 10=High)</p>

                            <p class="font-medium text-slate-700">3. Did any part of this work require you to betray your own values to "make the numbers"?</p>
                        </div>
                    </div>

                </div>
            </section>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Tab Switching Logic ---
            const tabNav = document.getElementById('tab-nav');
            const tabButtons = tabNav.querySelectorAll('.tab-btn');
            const tabContents = document.getElementById('tab-content-wrapper').querySelectorAll('.tab-content');

            tabNav.addEventListener('click', (e) => {
                const clickedTab = e.target.closest('.tab-btn');
                if (!clickedTab) return;

                const tabData = clickedTab.dataset.tab;

                // Update tab buttons
                tabButtons.forEach(btn => btn.classList.remove('active'));
                clickedTab.classList.add('active');

                // Update tab content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabData) {
                        content.classList.add('active');
                    }
                });
            });

            // --- Proof Card Flip Logic ---
            const proofCards = document.querySelectorAll('.proof-card');
            proofCards.forEach(card => {
                card.addEventListener('click', (e) => {
                    // Prevent flipping if a link inside the card is clicked (future-proofing)
                    if (e.target.closest('a')) return;
                    card.classList.toggle('is-flipped');
                });
            });

            // --- ProofBuilder Wizard Logic ---
            const proofForm = document.getElementById('proof-builder-form');
            const generateBtn = document.getElementById('generate-proof-btn');
            const newProofContainer = document.getElementById('new-proof-container');
            const newProofOutput = document.getElementById('new-proof-output');

            generateBtn.addEventListener('click', (e) => {
                e.preventDefault(); // Stop form submission

                // Get all values from the form
                const func = document.getElementById('wiz-function').value || "Not specified";
                const baseline = document.getElementById('wiz-baseline').value || "Not specified";
                const band = document.getElementById('wiz-band').value || "Not specified";
                const protocol = document.getElementById('wiz-protocol').value || "Not specified";
                const evidence = document.getElementById('wiz-evidence').value || "Not specified";
                const steward = document.getElementById('wiz-steward').value || "Not specified";
                const failure = document.getElementById('wiz-failure').value || "Not specified";

                // Get checklist values
                const checkOptIn = document.getElementById('wiz-check-opt-in').checked;
                const checkExit = document.getElementById('wiz-check-exit').checked;
                const checkNoCoercion = document.getElementById('wiz-check-no-coercion').checked;

                let identityText = "<ul>";
                if (checkOptIn) identityText += "<li class='list-disc list-inside'>Clear opt-in</li>";
                if (checkExit) identityText += "<li class='list-disc list-inside'>Right of Exit</li>";
                if (checkNoCoercion) identityText += "<li class='list-disc list-inside'>No coercion</li>";
                if (identityText === "<ul>") identityText = "Not specified";
                else identityText += "</ul>";

                // Create the new card HTML
                const newCardHTML = `
                    <div class="proof-card h-[400px] is-flipped"> <!-- Start flipped so back is visible -->
                        <div class="proof-card-inner">
                            <div class="proof-card-front p-6 justify-between">
                                <!-- Front is simple -->
                                <div>
                                    <span class="inline-block bg-gray-100 text-gray-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">L0 - Seed</span>
                                    <h3 class="text-2xl font-bold text-slate-900">${func.substring(0, 20)}...</h3>
                                    <p class="text-lg text-slate-600 mt-1">Your New Proof</p>
                                </div>
                                <div class="mt-4">
                                    <p class="text-3xl font-bold text-green-600">${band}</p>
                                    <p class="text-slate-500">Expected Outcome</p>
                                    <p class="mt-6 text-sm font-semibold text-indigo-600 text-center">Click to See Full Proof</p>
                                </div>
                            </div>
                            <div class="proof-card-back p-6">
                                <h4 class="text-lg font-bold text-slate-800 mb-4">Proof: ${func.substring(0, 30)}...</h4>
                                <dl><dt>Function & Context</dt><dd>${func}</dd></dl>
                                <dl><dt>Outcome Band</dt><dd>${band} (Baseline: ${baseline})</dd></dl>
                                <dl><dt>Protocol</dt><dd>${protocol}</dd></dl>
                                <dl><dt>Evidence & Robustness</dt><dd>${evidence}</dd></dl>
                                <dl><dt>Identity Integrity (ATCF)</dt><dd>${identityText}</dd></dl>
                                <dl><dt>Governance</dt><dd>${steward}</dd></dl>
                                <dl><dt>Failure Envelope</dt><dd>${failure}</dd></dl>
                            </div>
                        </div>
                    </div>
                `;

                // Add the new card and show the container
                newProofOutput.innerHTML = newCardHTML;
                newProofContainer.classList.remove('hidden');

                // Add flip listener to the new card
                const newCard = newProofOutput.querySelector('.proof-card');
                newCard.addEventListener('click', () => newCard.classList.toggle('is-flipped'));

                // Scroll to the new card
                newProofContainer.scrollIntoView({ behavior: 'smooth' });

                // Reset the form
                proofForm.reset();
            });

            // --- Failure Explorer Logic ---
            const failRunBtn = document.getElementById('fail-run-btn');
            const failResult = document.getElementById('fail-result');
            const failProofSelect = document.getElementById('fail-proof');
            const failStressSelect = document.getElementById('fail-stress');

            failRunBtn.addEventListener('click', () => {
                const proof = failProofSelect.value;
                const stress = failStressSelect.value;
                
                failResult.classList.remove('hidden', 'bg-red-100', 'text-red-900', 'bg-green-100', 'text-green-900', 'bg-yellow-100', 'text-yellow-900');
                
                if (stress === 'none') {
                    failResult.textContent = 'Please select a stressor to test.';
                    failResult.classList.add('bg-yellow-100', 'text-yellow-900');
                    return;
                }
                
                if (stress === 'fines') {
                    failResult.textContent = 'IDENTITY BREACH! Coercion violates ATCF. This "proof" is inadmissible.';
                    failResult.classList.add('bg-red-100', 'text-red-900');
                    return;
                }

                if (proof === 'energy' && stress === 'landlord') {
                    failResult.textContent = 'PROOF FAILED. Outcome collapses. This is outside the known "Failure Envelope."';
                    failResult.classList.add('bg-red-100', 'text-red-900');
                } else if (proof === 'housing' && stress === 'transit') {
                    failResult.textContent = 'PROOF FAILED. Outcome collapses. This is outside the known "Failure Envelope."';
                    failResult.classList.add('bg-red-100', 'text-red-900');
                } else {
                    failResult.textContent = 'PROOF STABLE. The selected stressor does not break this proof.';
                    failResult.classList.add('bg-green-100', 'text-green-900');
                }
            });
        });
    </script>
</body>
</html>
